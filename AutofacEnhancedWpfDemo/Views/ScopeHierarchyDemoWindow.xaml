<local:ScopedWindow xmlns:local="clr-namespace:AutofacEnhancedWpfDemo.Views"
                    x:Class="AutofacEnhancedWpfDemo.Views.ScopeHierarchyDemoWindow"
                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    Title="Scope Hierarchy Demo - Parent Window"
                    Width="800" Height="700"
                    WindowStartupLocation="CenterScreen"
                    Background="#F8F9FA">

	<local:ScopedWindow.Resources>
		<Style x:Key="ChildButton" TargetType="Button">
			<Setter Property="Padding" Value="20,16"/>
			<Setter Property="FontSize" Value="16"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="Cursor" Value="Hand"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border Background="{TemplateBinding Background}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
							<Border.Effect>
								<DropShadowEffect Color="#000000" Opacity="0.1" BlurRadius="10" ShadowDepth="0"/>
							</Border.Effect>
							<ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Opacity" Value="0.9"/>
				</Trigger>
			</Style.Triggers>
		</Style>
	</local:ScopedWindow.Resources>

	<Grid Margin="32">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<!-- Header -->
		<Border Grid.Row="0"
                Background="#9B59B6"
                CornerRadius="12"
                Padding="24"
                Margin="0,0,0,24">
			<Border.Effect>
				<DropShadowEffect Color="#000000" Opacity="0.1" BlurRadius="20" ShadowDepth="0"/>
			</Border.Effect>
			<StackPanel>
				<TextBlock Text="🔗 Parent-Child Scope Hierarchy Demo"
                           FontSize="28"
                           FontWeight="Bold"
                           Foreground="White"
                           Margin="0,0,0,8"/>
				<TextBlock Text="Open multiple non-modal child windows that share this parent scope"
                           FontSize="14"
                           Foreground="#ECF0F1"/>
			</StackPanel>
		</Border>

		<!-- Instructions -->
		<Border Grid.Row="1"
                Background="White"
                CornerRadius="8"
                Padding="20"
                Margin="0,0,0,16">
			<Border.Effect>
				<DropShadowEffect Color="#000000" Opacity="0.05" BlurRadius="10" ShadowDepth="0"/>
			</Border.Effect>
			<StackPanel>
				<TextBlock Text="📋 How It Works:"
                           FontWeight="Bold"
                           FontSize="15"
                           Margin="0,0,0,8"
                           Foreground="#1E293B"/>
				<TextBlock TextWrapping="Wrap"
                           Foreground="#64748B"
                           LineHeight="22"
                           FontSize="14">
					1️⃣ Click buttons below to open child windows (non-modal)<LineBreak/>
					2️⃣ Each child shares the SAME parent scope and services<LineBreak/>
					3️⃣ Modify products in ANY child window<LineBreak/>
					4️⃣ Changes are visible in ALL sibling windows (shared DbContext)<LineBreak/>
					5️⃣ Close THIS parent → all children close automatically! ⚡
				</TextBlock>
			</StackPanel>
		</Border>

		<!-- Buttons -->
		<Border Grid.Row="2"
                Background="White"
                CornerRadius="8"
                Padding="20"
                Margin="0,0,0,16">
			<Border.Effect>
				<DropShadowEffect Color="#000000" Opacity="0.05" BlurRadius="10" ShadowDepth="0"/>
			</Border.Effect>
			<StackPanel>
				<TextBlock Text="Open Child Windows:"
                           FontWeight="Bold"
                           FontSize="15"
                           Margin="0,0,0,12"
                           Foreground="#1E293B"/>
				<UniformGrid Rows="1" Columns="3">
					<Button Content="🔴 Child Window 1"
                            Command="{Binding OpenChild1Command}"
                            Background="#EF4444"
                            Style="{StaticResource ChildButton}"
                            Margin="0,0,8,0"/>
					<Button Content="🔵 Child Window 2"
                            Command="{Binding OpenChild2Command}"
                            Background="#3B82F6"
                            Style="{StaticResource ChildButton}"
                            Margin="4,0"/>
					<Button Content="🟢 Child Window 3"
                            Command="{Binding OpenChild3Command}"
                            Background="#10B981"
                            Style="{StaticResource ChildButton}"
                            Margin="8,0,0,0"/>
				</UniformGrid>
			</StackPanel>
		</Border>

		<!-- Log -->
		<Border Grid.Row="3"
                Background="White"
                CornerRadius="8"
                Padding="20">
			<Border.Effect>
				<DropShadowEffect Color="#000000" Opacity="0.05" BlurRadius="10" ShadowDepth="0"/>
			</Border.Effect>
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="*"/>
					<RowDefinition Height="Auto"/>
				</Grid.RowDefinitions>

				<TextBlock Grid.Row="0"
                           Text="📝 Activity Log"
                           FontWeight="Bold"
                           FontSize="15"
                           Margin="0,0,0,12"
                           Foreground="#1E293B"/>

				<Border Grid.Row="1"
                        Background="#F8F9FA"
                        CornerRadius="6"
                        Padding="12">
					<ScrollViewer VerticalScrollBarVisibility="Auto">
						<ItemsControl ItemsSource="{Binding LogMessages}">
							<ItemsControl.ItemTemplate>
								<DataTemplate>
									<TextBlock Text="{Binding}"
                                               FontFamily="Consolas"
                                               FontSize="13"
                                               Foreground="#334155"
                                               Margin="0,2"
                                               TextWrapping="Wrap"/>
								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>
					</ScrollViewer>
				</Border>

				<Button Grid.Row="2"
                        Content="🧹 Clear Log"
                        Command="{Binding ClearLogCommand}"
                        HorizontalAlignment="Right"
                        Padding="16,8"
                        Margin="0,12,0,0"
                        Background="#6B7280"
                        Foreground="White"
                        BorderThickness="0"
                        Cursor="Hand"/>
			</Grid>
		</Border>
	</Grid>
</local:ScopedWindow>