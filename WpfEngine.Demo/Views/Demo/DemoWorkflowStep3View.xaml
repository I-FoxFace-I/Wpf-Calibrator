<controls:BaseControlView  xmlns:controls="clr-namespace:WpfEngine.Core.Views.Controls;assembly=WpfEngine"
                           x:Class="WpfEngine.Demo.Views.DemoWorkflowStep3View"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="White">
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="32">
            <!-- Header -->
            <TextBlock Text="📋 Review Order" 
                       FontSize="24" 
                       FontWeight="Bold" 
                       Foreground="#1E293B"
                       Margin="0,0,0,8"/>
            <TextBlock Text="Review items and select shipping address" 
                       FontSize="14" 
                       Foreground="#64748B"
                       Margin="0,0,0,24"/>
            
            <!-- Customer Info -->
            <Border Background="#F1F5F9" 
                    CornerRadius="8" 
                    Padding="16"
                    Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="Customer" 
                               FontSize="12" 
                               Foreground="#64748B" 
                               Margin="0,0,0,4"/>
                    <TextBlock Text="{Binding CustomerName}" 
                               FontSize="16" 
                               FontWeight="SemiBold"/>
                </StackPanel>
            </Border>
            
            <!-- Order Items -->
            <TextBlock Text="Order Items" 
                       FontSize="16" 
                       FontWeight="SemiBold" 
                       Margin="0,0,0,12"/>
            
            <Border Background="White" 
                    BorderBrush="#E2E8F0" 
                    BorderThickness="1"
                    CornerRadius="8"
                    Margin="0,0,0,24">
                <DataGrid ItemsSource="{Binding OrderItems}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          IsReadOnly="True"
                          HeadersVisibility="Column"
                          GridLinesVisibility="None"
                          Background="White"
                          RowBackground="White"
                          AlternatingRowBackground="#F8FAFC"
                          BorderThickness="0">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Product" 
                                            Binding="{Binding ProductName}" 
                                            Width="*"/>
                        <DataGridTextColumn Header="Quantity" 
                                            Binding="{Binding Quantity}" 
                                            Width="100"/>
                        <DataGridTextColumn Header="Price" 
                                            Binding="{Binding Price, StringFormat=C}" 
                                            Width="120"/>
                        <DataGridTextColumn Header="Total" 
                                            Binding="{Binding Total, StringFormat=C}" 
                                            Width="120"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>
            
            <!-- Order Summary -->
            <Border Background="#F1F5F9" 
                    CornerRadius="8" 
                    Padding="20"
                    Margin="0,0,0,24">
                <StackPanel>
                    <Grid Margin="0,0,0,8">
                        <TextBlock Text="Subtotal:" HorizontalAlignment="Left"/>
                        <TextBlock Text="{Binding Subtotal, StringFormat=C}" 
                                   HorizontalAlignment="Right" 
                                   FontWeight="SemiBold"/>
                    </Grid>
                    <Grid Margin="0,0,0,8">
                        <TextBlock Text="VAT (21%):" HorizontalAlignment="Left"/>
                        <TextBlock Text="{Binding Tax, StringFormat=C}" 
                                   HorizontalAlignment="Right" 
                                   FontWeight="SemiBold"/>
                    </Grid>
                    <Border Height="1" Background="#CBD5E1" Margin="0,8"/>
                    <Grid Margin="0,8,0,0">
                        <TextBlock Text="Total:" 
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   HorizontalAlignment="Left"/>
                        <TextBlock Text="{Binding Total, StringFormat=C}" 
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   Foreground="#10B981"
                                   HorizontalAlignment="Right"/>
                    </Grid>
                </StackPanel>
            </Border>
            
            <!-- Shipping Address Selection -->
            <TextBlock Text="Shipping Address" 
                       FontSize="16" 
                       FontWeight="SemiBold" 
                       Margin="0,0,0,12"/>
            
            <!-- Existing Addresses -->
            <Border Background="White" 
                    BorderBrush="#E2E8F0" 
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,0,0,16"
                    Visibility="{Binding IsCreatingNewAddress, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverted}">
                <StackPanel>
                    <TextBlock Text="Select existing address:" 
                               FontSize="14" 
                               Margin="0,0,0,8"/>
                    <ComboBox ItemsSource="{Binding ShippingAddresses}"
                              SelectedItem="{Binding SelectedShippingAddress}"
                              DisplayMemberPath="FullAddress"
                              Padding="12,8"
                              FontSize="14"/>
                </StackPanel>
            </Border>
            
            <!-- New Address Form -->
            <Border Background="White" 
                    BorderBrush="#E2E8F0" 
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,0,0,16"
                    Visibility="{Binding IsCreatingNewAddress, Converter={StaticResource BoolToVisibilityConverter}}">
                <StackPanel>
                    <TextBlock Text="New shipping address:" 
                               FontSize="14" 
                               FontWeight="SemiBold"
                               Margin="0,0,0,12"/>
                    
                    <TextBlock Text="Street" Margin="0,0,0,4"/>
                    <TextBox Text="{Binding NewStreet, UpdateSourceTrigger=PropertyChanged}" 
                             Padding="8" 
                             Margin="0,0,0,12"/>
                    
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="12"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="City" Margin="0,0,0,4"/>
                            <TextBox Text="{Binding NewCity, UpdateSourceTrigger=PropertyChanged}" 
                                     Padding="8"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Zip Code" Margin="0,0,0,4"/>
                            <TextBox Text="{Binding NewZipCode, UpdateSourceTrigger=PropertyChanged}" 
                                     Padding="8"/>
                        </StackPanel>
                    </Grid>
                    
                    <TextBlock Text="Country" Margin="0,0,0,4"/>
                    <TextBox Text="{Binding NewCountry, UpdateSourceTrigger=PropertyChanged}" 
                             Padding="8"/>
                </StackPanel>
            </Border>
            
            <!-- Toggle New Address Button -->
            <Button Content="{Binding IsCreatingNewAddress, Converter={StaticResource BoolToStringConverter}, ConverterParameter='Use Existing Address|+ Add New Address'}"
                    Command="{Binding ToggleNewAddressCommand}"
                    Padding="16,10"
                    Margin="0,0,0,24"
                    Background="White"
                    BorderBrush="#10B981"
                    BorderThickness="2"
                    Foreground="#10B981"
                    FontWeight="SemiBold"
                    Cursor="Hand"/>
            
            <!-- Action Buttons -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="← Back" 
                        Command="{Binding BackCommand}"
                        Padding="20,12"
                        Margin="0,0,12,0"
                        Background="White"
                        BorderBrush="#CBD5E1"
                        BorderThickness="1"
                        FontWeight="SemiBold"
                        Cursor="Hand"/>
                
                <Button Content="✓ Complete Order" 
                        Command="{Binding CompleteCommand}"
                        Padding="20,12"
                        Background="#10B981"
                        Foreground="White"
                        BorderThickness="0"
                        FontWeight="SemiBold"
                        Cursor="Hand"/>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</controls:BaseControlView>